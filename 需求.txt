# 坦克大戰專題需求與進度表

## 基本需求(不要改動)

### 遊戲概念
- **視角**: 第三人稱/第一人稱
- **場景**: 固定大小立方體籠子(cube cage)，有邊界
- **光照**: 場景正中間天花板有點光源，實現Phong光照(自定義著色器)

### 坦克控制
- **移動**: A原地左轉、D原地右轉  
- **砲管**: 指向坦克前方
- **射擊**: 空白鍵發射砲彈(直進圓球 碰到地圖邊界或任意物體後損毀)

### 坦克模型 (簡單幾何)
- **底座**: 長方體
- **砲座**: 長方體  
- **砲管**: 圓柱體 從核心向前平伸
- **砲彈**: 圓球
- 在local space組裝好再進world space

### 砲彈物理
- 固定速度發射
- 撞擊到任意物體後損毀 射程到40 場上同時只能存在3顆砲彈 彈藥共有10發 
- 若命中目標(追蹤砲彈跟目標的距離 若距離<目標半徑則命中) 摧毀該目標與該命中砲彈 並且彈藥量根據命中種類增加

### 目標物體
- **白球**: 1分，半徑20 加一顆彈藥
- **籃球**: 5分，半徑20  加兩顆彈藥
- **紅球**: 10分，半徑20 加三顆彈藥

## 專案檔案結構

```
D:.
│   .gitignore
│   index.html
│   test.html
│   需求.txt
│   
├───assets
│   └───textures
│       │   ground.jpg
│       │   metal.jpg
│       │   tank_barrel.jpg
│       │   tank_base.jpg
│       │   tank_turret.jpg
│       │   target_texture.jpg
│       │
│       └───skybox
│               nx.jpg
│               ny.jpg
│               nz.jpg
│               px.jpg
│               py.jpg
│               pz.jpg
│
├───css
│       style.css
│
├───js
│   │   main.js
│   │
│   ├───engine
│   │       Camera.js
│   │       InputHandler.js
│   │       Lighting.js
│   │       Physics.js
│   │       ShadowRenderer.js
│   │
│   ├───game
│   │       Bullet.js
│   │       BulletManager.js
│   │       GameManager.js
│   │       Scene.js
│   │       Tank.js
│   │       Target.js
│   │
│   ├───ui
│   │       UI.js
│   │
│   ├───utils
│   │       CollisionUtils.js
│   │       SystemCheck.js
│   │       Utils.js
│   │
│   └───webgl
│           FrameBuffer.js
│           MatrixLib.js
│           ShaderManager.js
│           TextureManager.js
│           WebGLCore.js
│
└───shaders
        phong.frag
        phong.vert
        skybox.frag
        skybox.vert
```

# 進度追蹤(可以改)

## 作業要求分析 (PDF)

### ✅ Required User Interaction (30%)
- [x] **Player物體**: 坦克作為player，可移動旋轉
- [x] **第一人稱視角**: 攝影機跟隨坦克
### ✅ 視角控制系統
- [x] **P鍵**: 切換第一人稱↔第三人稱視角
- [x] **Q鍵**: 第三人稱時，視角以坦克為中心左轉90度
- [x] **E鍵**: 第三人稱時，視角以坦克為中心右轉90度
- [x] **第一人稱**: 攝影機位於坦克內部，跟隨坦克移動旋轉
- [x] **第三人稱**: 固定距離俯視坦克，可用Q/E鍵旋轉視角

### 🔄 Technical Requirements (30%)  
- [x] **Point Light + Phong**: 1個點光源，local illumination (ambient+diffuse+specular)
- [x] **Texture Mapping**: 地面使用ground.jpg紋理
- [x] **Environment Cube Map**: 天空盒背景已實現
- [ ] **Cube Map Reflection/Refraction**: 至少1個物體（需新增）
- [x] **Moving Objects**: 目標球旋轉
- [ ] **介紹文字**: 網頁底部說明

### ✅ Pick 2 out of 3 (20%)
- [x] **Shadow**: 陰影效果
- [x] **Dynamic Reflection**: 動態反射
- [ ] **Bump Mapping**: 不選

### ⚠️ 技術限制
- [x] **禁用Three.js**: 必須用純WebGL實現

### ✅ 場景與物理設定
- [x] **場景大小**: 立方體1600x1600x1600單位
- [x] **球體統一半徑**: 20單位 (所有球都相同大小)
- [x] **砲管仰角範圍**: -10°到+45°
- [x] **砲彈發射速度**: 30單位/秒 (60fps)
- [x] **坦克移動速度**: 適中速度 (待實作時調整)
- [x] **重力加速度**: 9.8單位/秒²

### ✅ 遊戲機制
- [x] **目標球數量**: 白球10個、藍球5個、紅球1個
- [x] **目標生成機制**: 隨機位置，被擊中後10秒重生
- [x] **遊戲結束條件**: 無限制遊戲
- [x] **重新開始機制**: 按R鍵重置
- [x] **計分顯示**: 畫面正中間上方記分板
- [x] **碰撞效果**: 無爆炸效果或音效
- [x] **坦克邊界**: 撞牆停止，無模型碰撞

### ✅ 碰撞與計分系統
- [x] **統一球體大小**: 白球、藍球、紅球半徑都設為20單位
- [x] **運動速率調整**: 目標球旋轉/移動速度減半
- [x] **距離碰撞檢測**: 砲彈中心與球體中心距離 < (砲彈半徑 + 球體半徑)
- [x] **命中獎勵**: 白球+1彈藥，藍球+2彈藥，紅球+3彈藥
- [x] **目標移除**: 被命中的目標球和砲彈同時銷毀

### ✅ 技術實現
- [x] **自定義Phong著色器**: Ambient + Diffuse + Specular 完整模型
- [x] **陰影**: 使用FBO實現陰影效果
- [x] **碰撞檢測**: 球體碰撞檢測
- [x] **砲彈生命週期**: 撞到物體或邊界即損毀，最多飛10秒，最多同時5顆砲彈
- [x] **天空盒**: 使用Cube Map實現環境背景
- [x] **地面紋理**: 使用ground.jpg渲染地面

## 新增功能需求

### 🔴 必須新增的功能
- [ ] **Cube Map反射/折射**: 至少1個物體實現反射或折射效果
- [ ] **介紹文字**: 網頁底部添加專題說明

### 🟢 已完成功能
- [x] **視角切換系統**: 第一人稱(預設) ↔ 第三人稱
- [x] **紋理映射**: 地面加載ground.jpg紋理圖片
- [x] **環境Cube Map**: 天空盒背景
- [x] **場景地面**: 使用ground.jpg紋理的地面平面